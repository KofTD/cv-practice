# Практическая работа №1. Обработка изображений с использованием библиотеки OpenCV

## 1. Функция изменения разрешения изображения

**Входные параметры**
 - изображение
 - желаемая ширина
 - желаемая высота
 - коэффициент масштабирования

**Алгоритм**
 - Если указан коэффициент масштабирования, он используется для изменения размерности изображения в    указанное количество раз,
     иначе, если указаны и ширина и высота - размерность приводится к указанным,
     иначе, если указана только одна из величин, она приводится к указанной, а 2я величина приводится к величине, сохраняющей соотносшение сторон,
     иначе возвращается исходное изображение.
 - Создаётся чёрное изображение желаемых размеров, создаётся координатная сетка для нового изображения, сетка масштабирется к рамерам исходного изображения
 - Создаются матрицы координат для доступа к пикселям исходного изображения (X, Y)
 - Новое изображение заполняется пикселями из исходного (Пиксель новго изображения с координатами (i, j) принимает значение пикселя нового изображения с координатами (Y(i,j), X(i,j)) )

## 2. Функция применения фотоэффекта сепии к изображению

**Входные параметры**
 - изображение
 - интенсивность эффекта

**Алгоритм**
 - Создаётся матрица сепии в транспонированном виде (для последующего удобного умножения строки на матрицу)
 - Матрица изменяется под действием интенсивности (intensity = 1.0 - полный эффект сепии, intensity = 0.0 - не изменённое изображение)
 - Для применения к пикселю эффекта сепии нужно умножить матрицу сепии на вектор-столбец (B, G, R), а результат записать как цвет пикселя, однако в силу несогласованностти размерностей такое умножение недоступно, однако доступно умножение справа на матрицу
 - Для получения того же результата от умножения вектор-строки (B, G, R) на матрицу, матрицу сепии было необходимо транспонировать
 - На случай, если какой-то элемент выйдет за границу [0, 255], все цвета нужно привести к указанному отрезку


## 3. Функция применения фотоэффекта виньетки к изображению

**Входные параметры**
 - изображение
 - интенсивность эффекта виньетки
 - радиус эффекта виньетки
 - центр эффекта виньетки

**Алгоритм**
 - Если центр не указан, он устанавливается по центру самого изображения
 - Создаются сетки координат по осям y и x, затем из них путём сложения "каждый с каждым" получается матрица расстояний пискелей от заданного центра
 - Вычисляется максимальное расстояние от центра до пикселя на картинке
 - Матрица расстояний нормализуется по максимальному расстоянию умноженному на радиус
 - Получаем матрицу - маску виньетки (элемент = 1.0, если он соответствует центру виньетки, элемент = 0.0, если он отстранён от центра виньетки на расстояние >= радиус * макс. расстояние)
 - Маска виньетки корректируется на интенсивность (при intensity = 0.0 эффект виньетки отсутствует (все значения в маске = 1.0), при увеличении интенсивности значения маски стремятся к 0.0)
 - Маска виньетки применяется к изображению (цвета пикселей с координатами (i,j) умножаются на значение маски с теми же индексами)
 - Получаем изображение которое плавно темнеет по отдалению от заданного центра: радиус отвечает за расстояние, после которого все пиксели - чёрные, интенсивность отвечает за скорость затемнения пикселей

## 4. Функция пикселизации заданной прямоугольной области изображения

**Входные параметры**
 - изображение
 - ширина региона пикселизации
 - высота региона пикселизации
 - размер пикселя

**Алгоритм**
 - Создана функция, обрабатывающая события мыши, при её передвижении в прямоугольнике с центром в местонахождении курсора и заданными размерами происходит пикселизация:
   - Задаются координаты левого вернего и правого нижнего углов прямоугольника пикселизации, этот прямоугольник "достаётся" из изображения
   - Для самой пикселизации будет использована функция изменения разрешения: сначала снижаем разрешение в pixel_size раз, а затем возвращаем исходный размер изображению и получаем прямоугольник из пикселей заданного размера
   - Возвращем модифицированный прямоугольник на место
 - Создаётся окно и к нему привязывается функция-обработчик
 - Запускается основной цикл, показывающий изображение и обрабатывающий горячие клавиши

## 5. Функция наложения прямоугольной одноцветной рамки заданной ширины по краям изображения

**Входные параметры**
 - изображение
 - ширина рамки
 - цветовая палитра рамки

**Алгоритм**
 - Если ширина рамки(frame_width) не указана, она по умолчанию берётся 1/10 от минимума ширины и высоты изображения
 - Затем первые и последние frame_width строк и столбцов матрицы изображения становятся равными указанному цевту

## 6. Функция наложения фигурной одноцветной рамки по краям изображения

**Входные параметры**
 - изображение
 - номер фигурной рамки (выбор из имеющихся вариантов)
 - критическое расстояние цветового различия (нужно для отделения рамки от фона)

**Алгоритм**
 - Если размер рамки не совпадает с размером изображения, размер рамки подгоняется под размер изображения
 - Из массива достаётся цвет фона выбранной рамки
 - Находится евклидово расстояние цвета каждого пикселя от цвета фона, если оно больше чем заданное критическое расстояние, пиксель признаётся частью рамки
 - Создаётся маска изображения (1 - пиксель принадлежит рамке, 0 - пиксель принадлежит фону)
 - Изображение и рамка складываются с учётом маски

## 7. Функция наложения эффекта бликов объектива камеры

**Входные параметры**
 - изображение
 - сила наложения эффекта
 - коэффициент изменения размера блика
 - центр блика 

**Алгоритм**
 - Если центр не задан, он задаётся автоматически
 - Размерность блика изменяется в соответствии с указанным коэфиициентом, находятся координаты углов будующего места расположения блика (с учётом возможности выхода за границу изображения)
 - В этом месте происходит сложение изображений с поправкой на силу наложения эффекта (чем сильнее эффетк - тем ярче будет блик)

## 8. Функция наложения текстуры акварельной бумаги

**Входные параметры**
 - изображение
 - интенсивность
 - сила наложения текстуры

**Алгоритм**
 - Если размер текстуры не совпадает с размером изображения, размер текстуры подгоняется под размер изображения
 - На основе нормализованных яркостей пикселей текстуры создаётся маска в диапазоне [0.0;1.0], значение 1.0 будет в самых тёмных областях текстуры, там она будет иметь наибольший эффект на изображения, значение 0.0 будет в самых светлых областях текстуры, там она будет иметь наименьший эффект
 - Применяется значение силы текстуры, которое влияет на контрастность будубщего изображения (чем выше сила - тем выше контрастность)
затем происходит смешивание изображений с поправкой на интенсивность накладываемого эффекта


















